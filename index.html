<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Unpro BUG</title>

<meta name="description" content="Unpro BUG">
<meta name="author" content="Jiang WU">
<link rel="canonical" href="https://unprobug.com/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.35cd0f65a15cafa92372b8313deef5960aae04b90ad722f2bbf509eb0468137e.css" integrity="sha256-Nc0PZaFcr6kjcrgxPe71lgquBLkK1yLyu/UJ6wRoE34=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://unprobug.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://unprobug.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://unprobug.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://unprobug.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://unprobug.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.86.1" />
<link rel="alternate" type="application/rss+xml" href="https://unprobug.com/index.xml">
<link rel="alternate" type="application/json" href="https://unprobug.com/index.json">
<link rel="alternate" hreflang="en" href="https://unprobug.com/" />
<link rel="alternate" hreflang="cn" href="https://unprobug.com/cn/" />
<link rel="alternate" hreflang="about me" href="https://unprobug.com/about-me/" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-QNSJ3VFPDD"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-QNSJ3VFPDD', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Unpro BUG" />
<meta property="og:description" content="Unpro BUG" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://unprobug.com/" /><meta property="og:image" content="https://unprobug.com/papermod-cover.png"/>

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://unprobug.com/papermod-cover.png"/>

<meta name="twitter:title" content="Unpro BUG"/>
<meta name="twitter:description" content="Unpro BUG"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Unpro BUG",
  "url": "https://unprobug.com/",
  "description": "Unpro BUG",
  "thumbnailUrl": "https://unprobug.com/favicon.ico",
  "sameAs": [
      "https://github.com/wallisnow", "index.xml"
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://unprobug.com/" accesskey="h" title="Unpro BUG (Alt + H)">Unpro BUG</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://unprobug.com/cn/" title="中文"
                            aria-label="🌟">🌟</a>
                    </li>
                    <li>
                        <a href="https://unprobug.com/about-me/" title="About Me"
                            aria-label="About Me">About Me</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://unprobug.com/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://unprobug.com/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://unprobug.com/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://unprobug.com/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://unprobug.com/copyright" title="Copyright">
                    <span>Copyright</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>Unprofessional BUG</h1>
    </header>
    <section class="entry-content">
        <p>命中有时终须有,命中无时莫强求</p>
    </section>
    <footer class="entry-footer">
        <div class="social-icons">
    <a href="https://github.com/wallisnow" target="_blank" rel="noopener noreferrer me" title="Github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
    </a>
    <a href="index.xml" target="_blank" rel="noopener noreferrer me" title="RsS">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
    </a>
</div>

    </footer>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>[ansible]key value list 转 dictionary</h2>
  </header>
  <section class="entry-content">
    <p>需求 这两天我需要kubernetes 上面没有ready 的pod列出来, 然后对这些pod进行操作, 又要用到ansible, 思来想去不如来个map, 那么 python 或者ansible里面叫dict
输入 这里有一个 kubectl get pods 得出的结果, 使用ansible的 shell, 我们需要处理其中的stdout, 或者stdout_lines
changed: [localhost -&gt; fd00:eccd:0:a0a::5] =&gt; { &#34;ansible_facts&#34;: { &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python&#34; }, &#34;changed&#34;: true, &#34;cmd&#34;: &#34;/usr/local/bin/kubectl get pods -n kube-system --field-selector spec.nodeName=poolalpha-worker-0-efggjjp-ansibd-01 -o custom-columns=NAME:.metadata.name,\&#34;IS_READY\&#34;:.status.containerStatuses[].ready --no-headers&#34;, &#34;delta&#34;: &#34;0:00:00.475861&#34;, &#34;end&#34;: &#34;2021-07-29 19:37:41.515968&#34;, &#34;invocation&#34;: { &#34;module_args&#34;: { &#34;_raw_params&#34;: &#34;/usr/local/bin/kubectl get pods -n kube-system --field-selector spec.nodeName=poolalpha-worker-0-efggjjp-ansibd-01 -o custom-columns=NAME:.metadata.name,\&#34;IS_READY\&#34;:.status.containerStatuses[].ready --no-headers&#34;, &#34;_uses_shell&#34;: true, &#34;argv&#34;: null, &#34;chdir&#34;: null, &#34;creates&#34;: null, &#34;executable&#34;: null, &#34;removes&#34;: null, &#34;stdin&#34;: null, &#34;stdin_add_newline&#34;: true, &#34;strip_empty_ends&#34;: true, &#34;warn&#34;: true } }, &#34;rc&#34;: 0, &#34;start&#34;: &#34;2021-07-29 19:37:41....</p>
  </section>
  <footer class="entry-footer">July 30, 2021&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Jiang WU</footer>
  <a class="entry-link" aria-label="post link to [ansible]key value list 转 dictionary" href="https://unprobug.com/post/ansible/key_value_list_to_dict/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>[kubernetes]如何查看node的kubelet配置</h2>
  </header>
  <section class="entry-content">
    <p>0. 前言 有时因为一些原因, 我们需要修改kubelet 的配置, 新版本的kubernetes就是修改 config.yml, 那么这里有一个问题, 你怎么知道你的kubelet 已经生效了?
1. 先说结论 查询方法为先开启kube proxy然后使用 kubernetes 提供的查询接口
api/vi/nodes/&lt;node_name&gt;/proxy/cofigz 2. 举个栗子 例如我们有这样一个集群:
test@node-01:~&gt; kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME master-0-01 Ready control-plane,master 16h v1.21.1 10.0.10.9 &lt;none&gt; SUSE Linux Enterprise Server 15 SP2 5.3.18-24.67-default containerd://1.4.4 master-1-01 Ready control-plane,master 16h v1.21.1 10.0.10.10 &lt;none&gt; SUSE Linux Enterprise Server 15 SP2 5.3.18-24.67-default containerd://1.4.4 master-2-01 Ready control-plane,master 16h v1....</p>
  </section>
  <footer class="entry-footer">July 26, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Jiang WU</footer>
  <a class="entry-link" aria-label="post link to [kubernetes]如何查看node的kubelet配置" href="https://unprobug.com/post/kubernetes/how_to_check_kubelet_of_node/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>[docker] centos8 安装docker</h2>
  </header>
  <section class="entry-content">
    <p>1. 前置条件 准备一台centos 8 的机器, 我这里用的是vagrant安装的centos8镜像
2. 安装过程 2.1 测试是否链接外网 $ ping google.com PING google.com (216.58.211.14) 56(84) bytes of data. 64 bytes from muc03s13-in-f14.1e100.net (216.58.211.14): icmp_seq=1 ttl=63 time=11.5 ms 64 bytes from muc03s13-in-f14.1e100.net (216.58.211.14): icmp_seq=2 ttl=63 time=12.1 ms ^C --- google.com ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 2ms rtt min/avg/max/mdev = 11.476/11.781/12.086/0.305 ms 2.2 删除旧的docker $ sudo yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-engine 2....</p>
  </section>
  <footer class="entry-footer">July 19, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Jiang WU</footer>
  <a class="entry-link" aria-label="post link to [docker] centos8 安装docker" href="https://unprobug.com/post/docker/how_to_install_docker_in_centos8/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>[Vagrant] 入门</h2>
  </header>
  <section class="entry-content">
    <p>1.什么是vagrant 具体定义大家可以参见官方网站: https://www.vagrantup.com/.
那么大白话vagrant 到底是干嘛的, 它和docker有点像, 甚至部分操作用过docker 的人都会觉得似曾相识, 我们知道, docker 是来管理container的, 而vagrant是来管理虚拟机的, 比如你有个tomcat, 这个tomcat可以运行在docker容器上, 我们通过docker来管理这个容器, 而这个docker容器可以运行在VM上, 而vagrant可以是用来管理这个VM的, 当然, 这个只是一个宽泛的解释, 具体还是需要深入理解其本质.
2.如何工作 vagrant 通过不同的provider 来对虚拟机软件的API进行调用, 例如 virtualbox, 那么vagrant 通过virtualbox provider 来操作VM. 也就省去了我们手动创建的麻烦 3. 安装  更多方式: https://www.vagrantup.com/downloads
  Linux/Ubuntu  curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add - sudo apt-add-repository &#34;deb [arch=amd64] https://apt.releases.hashicorp.com $(lsb_release -cs) main&#34; sudo apt-get update &amp;&amp; sudo apt-get install vagrant   Windows 这里注意，如果你使用virtualbox或者vmware,　并且运行你普通使用创建vm没问题，那么你只需要根据上面的链接安装vagrant, 如果你不要 因为vagrant需要hyper-v, 所以你要打开自己的windows hyper-v, 传送门 然后根据上面的下载地址，下载安装...</p>
  </section>
  <footer class="entry-footer">July 14, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Jiang WU</footer>
  <a class="entry-link" aria-label="post link to [Vagrant] 入门" href="https://unprobug.com/post/vagrant/vagrant_for_beginners/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>[kubernetes] kustomize 入门例子</h2>
  </header>
  <section class="entry-content">
    <p>0. 简介 kustomize 形如customize, 也就是k8s&#43;customize, 它是kube资源描述文件的一种抽象工具.
 官方地址: https://kustomize.io/
 1. 为什么会用 kustomize kustomize它作用类似Helm, 它的实现方式和helm不同, helm是基于模版, 而kustomize是基于overlay 引擎. 通俗讲就是说, 你写一个普通的k8s资源描述yaml文件, 那么所有东西都是写死的, 此时如果你有helm, 你可以把部分值写成变量模版, 达到灵活的目的. 而kustomize更像是代码式的声明将,基代码和定制化代码重叠, 达到灵活的目的, 有时我们的配置比较简单且固定, 此时, 我们更希望一种快捷易于操作的方式, 那么此时就可以考虑kustomize, 当然这不代表kustomize只能写简单的东西.
我们来看一下需求是怎么来的:
假设我们有一个pod.yaml:
# pod.yaml contents apiVersion: v1 kind: Pod metadata: name: myapp-pod labels: app: myapp spec: containers: - name: web image: web:v.1.0 一切看起来都很好, 突然有一天, 老板说, 我们客户给了一个新环境, 我们得再部署一套应用到名叫XINHUANJING的新环境, 此时你可能会说, 好办, 看我粘贴复制大法, 只需改点点配置.
# pod.yaml contents apiVersion: v1 kind: Pod metadata: name: XINHUANJING-myapp-pod labels: app: myapp spec: containers: - name: web image: web:v....</p>
  </section>
  <footer class="entry-footer">July 12, 2021&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Jiang WU</footer>
  <a class="entry-link" aria-label="post link to [kubernetes] kustomize 入门例子" href="https://unprobug.com/post/kubernetes/how_to_use_kustomize/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://unprobug.com/page/2/">Next Page »</a>
  </nav>
</footer>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://unprobug.com/">Unpro BUG</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
